<div class="max-w-6xl mx-auto">
  <h1 class="text-2xl font-bold text-gray-800 mb-4">ğŸšš Theo DÃµi ÄÆ¡n HÃ ng TrÃªn Blockchain</h1>

  <!-- Loading -->
  <div *ngIf="loading" class="text-center py-10 text-gray-500">
    Äang táº£i dá»¯ liá»‡u Ä‘Æ¡n hÃ ng...
  </div>

  <!-- KhÃ´ng cÃ³ Ä‘Æ¡n -->
  <div *ngIf="!loading && shippingOrders.length === 0" class="bg-white p-10 rounded-xl text-center shadow-md">
    <p class="text-gray-500">Báº¡n hiá»‡n khÃ´ng cÃ³ Ä‘Æ¡n hÃ ng nÃ o Ä‘ang giao.</p>
  </div>

  <!-- Danh sÃ¡ch Ä‘Æ¡n hÃ ng Ä‘ang giao -->
  <div *ngIf="!loading && shippingOrders.length > 0" class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div *ngFor="let order of shippingOrders" class="bg-white rounded-xl shadow p-6 hover:shadow-lg transition">
      <div class="flex justify-between items-center border-b pb-2 mb-3">
        <div class="font-semibold text-gray-800">
          MÃ£ Ä‘Æ¡n: {{ order.orderCode || order.shipmentID }}
        </div>
        <span
          [style.background-color]="getStatusMeta(order.status).bgColor"
          [style.color]="getStatusMeta(order.status).color"
          class="px-3 py-1 rounded-full text-xs font-semibold"
        >
          {{ getStatusMeta(order.status).label }}
        </span>
      </div>

      <div class="text-gray-600 text-sm mb-1">ğŸ“ {{ order.currentLocation || order.shippingAddress }}</div>
      <div class="text-gray-600 text-sm mb-4">ğŸ•“ {{ order.lastUpdated | date:'dd/MM/yyyy HH:mm' }}</div>

      <div class="flex justify-between mt-4">
        <button
          (click)="viewHistory(order)"
          class="bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-600 transition"
        >
          Xem lá»‹ch sá»­ Blockchain
        </button>
        <button
          (click)="confirmReceived(order)"
          class="bg-green-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-green-600 transition"
        >
          ÄÃ£ nháº­n hÃ ng
        </button>
      </div>
    </div>
  </div>

  <!-- Modal lá»‹ch sá»­ Blockchain -->
  <div *ngIf="selectedOrder" class="fixed inset-0 bg-black/40 flex justify-center items-center z-50">
    <div class="bg-white rounded-xl w-full max-w-2xl p-6 relative shadow-lg">
      <button
        (click)="closeModal()"
        class="absolute top-3 right-3 text-gray-400 hover:text-gray-600"
      >
        âœ–
      </button>

      <h2 class="text-xl font-semibold text-gray-800 mb-4">
        Lá»‹ch sá»­ Blockchain - {{ selectedOrder.orderCode || selectedOrder.shipmentID }}
      </h2>

      <div *ngIf="loadingHistory" class="text-center text-gray-500 py-10">
        Äang táº£i lá»‹ch sá»­ tá»« blockchain...
      </div>

      <div *ngIf="!loadingHistory && orderHistory.length > 0" class="space-y-4 max-h-[400px] overflow-y-auto pr-2">
        <div *ngFor="let record of orderHistory" class="border-l-4 border-blue-500 pl-4 relative">
          <div class="absolute w-3 h-3 bg-blue-500 rounded-full -left-[6px] top-1"></div>
          <p class="font-semibold text-gray-800">{{ record.status }}</p>
          <p class="text-sm text-gray-600">{{ record.location }}</p>
          <p class="text-xs text-gray-500">ğŸ‘¤ {{ record.actor }}</p>
          <p class="text-xs text-gray-400">ğŸ•“ {{ record.timestamp | date:'dd/MM/yyyy HH:mm:ss' }}</p>
        </div>
      </div>

      <div *ngIf="!loadingHistory && orderHistory.length === 0" class="text-center text-gray-500 py-6">
        KhÃ´ng cÃ³ dá»¯ liá»‡u lá»‹ch sá»­ trÃªn blockchain.
      </div>
    </div>
  </div>
</div>
