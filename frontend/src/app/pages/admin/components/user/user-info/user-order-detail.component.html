<div class="relative p-4 rounded-xl shadow bg-white">
  <header class="flex items-center justify-between mb-6">
    <!-- Nút quay lại -->
    <button
      (click)="goBack()"
      class="flex items-center text-gray-500 hover:text-gray-700"
      type="button"
    >
      <fa-icon [icon]="faArrowLeft"></fa-icon>
      <span class="ml-2">Quay lại</span>
    </button>

    <!-- Tiêu đề -->
    <h1 class="text-2xl font-bold text-gray-800 text-center flex-1">
      Thông tin khách hàng
    </h1>

    <!-- Nút Hủy / Lưu -->
    <div class="flex gap-3">
      <button
        (click)="goBack()"
        class="flex items-center bg-white text-red-600 border border-red-500 px-4 py-2 rounded-xl shadow hover:bg-red-50 transition"
        type="button"
      >
        <fa-icon [icon]="faClose"></fa-icon>
        <span class="ml-2 font-medium">Hủy</span>
      </button>
      <button
        [disabled]="isLoading"
        class="flex items-center bg-blue-600 text-white px-4 py-2 rounded-xl shadow hover:bg-blue-700 transition"
        type="submit"
      >
        <fa-icon [icon]="faSave"></fa-icon>
        <span class="ml-2 font-medium">Lưu</span>
      </button>
    </div>
  </header>

  <main class="grid lg:grid-cols-3 gap-4 mb-6">
    <!-- left -->
    <div class="lg:col-span-2 space-y-4">
      <section class="bg-white p-4 rounded-xl shadow space-y-4">
        <div class="flex items-start gap-4 border-b border-gray-200 pb-7 mb-2">
          <ng-container *ngIf="userDetail.avatar; else noAvatar">
            <div class="relative w-16 h-16">
              <img [ngSrc]="userDetail.avatar" alt="avatar"
                   class=" rounded-full object-cover"
                   fill/>
            </div>
          </ng-container>
          <ng-template #noAvatar>
            <div
              class="w-16 h-16 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center font-bold">
              {{ userDetail.fullName.charAt(0).toUpperCase() }}
            </div>
          </ng-template>
          <div class="flex flex-col">
            <span class="font-bold text-lg">{{ userDetail.fullName }}</span>
            <span class="text-gray-500 text-sm mt-1.5">{{ userDetail.address }}</span>
            <span class="text-gray-500 text-sm">{{ countOrder }} đơn hàng</span>
            <span class="text-gray-500 text-sm">Khách hàng {{ userDetail.daysJoined }} ngày</span>
          </div>
        </div>
        <div class="gap-2">
          <span class="font-bold text-lg">Ghi chú khách hàng</span>
          <div class="mt-4">
            <span class="text-gray-500">Ghi chú</span>
            <textarea class="border border-gray-200 w-full rounded-sm"></textarea>
          </div>
        </div>
      </section>

      <section class="bg-white p-4 rounded-xl shadow space-y-4">
        <h2 class=" font-bold text-lg">Đơn hàng của khách</h2>
        <ng-container *ngIf="countOrder>0; else noOrder">
          <table class="table-auto w-full text-left">
            <thead class="bg-gray-50 text-gray-600 text-sm font-semibold border-b">
            <tr>
              <th class="p-3">Mã đơn</th>
              <th class="p-3">Ngày đặt</th>
              <th class="p-3">Trạng thái</th>
              <th class="p-3">Giá trị</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let user of userDetail.userOrderDetailResponse"
                class="border-b hover:bg-gray-50 transition">
              <td class="p-3">{{ user.orderCode }}</td>
              <td class="p-3">{{ user.formattedDate }}</td>
              <td class="p-3">
                <span [appStatus]="OrderStatusMeta[user.orderStatus]"
                      class="inline-block px-2 py-1 rounded-full"></span>
              </td>
              <td class="p-3">{{ user.orderPrice | currency:'VND' }}</td>
            </tr>
            </tbody>
          </table>
        </ng-container>
        <ng-template #noOrder>
          <span>Người dùng chưa có đơn hàng nào</span>
        </ng-template>
      </section>
    </div>

    <!-- right -->
    <div class="space-y-4">
      <section class="bg-white p-4 rounded-xl shadow space-y-4">
        <h2 class="font-bold text-lg">Tổng quan</h2>
        <div class="gap-4 border-b border-gray-200">
          <ng-container *ngIf="userDetail.address">
            <div class="flex flex-col py-1 gap-1 ">
              <span class="text-gray-400">Địa chỉ</span>
              <span class="text-gray-700">{{ userDetail.address }}</span>
            </div>
          </ng-container>

          <ng-container *ngIf="userDetail.email">
            <div class="flex flex-col py-1 gap-1 ">
              <span class="text-gray-400">Email</span>
              <span class="text-gray-700">{{ userDetail.email }}</span>
            </div>
          </ng-container>

          <ng-container *ngIf="userDetail.phone">
            <div class="flex flex-col py-1 gap-1 ">
              <span class="text-gray-400">Số điện thoại</span>
              <span class="text-gray-700">{{ userDetail.phone }}</span>
            </div>
          </ng-container>
        </div>
        <button (click)="deleteUser()"
                class="text-red-500"
                type="button">
          Xóa khách hàng
        </button>
      </section>
    </div>
  </main>
</div>
